---
title: "An introduction to R"
subtitle: "üåê<br/>  Geocomputation with R"
author: "Robin Lovelace, Jannes Menchow and Jakub Nowosad"
date: " "
output:
  xaringan::moon_reader:
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
bibliography: refs-all.bib
---

```{r setup, include = FALSE}
options(htmltools.dir.version = FALSE)
library(RefManageR)
BibOptions(check.entries = FALSE, 
           bib.style = "authoryear", 
           cite.style = 'alphabetic', 
           style = "markdown",
           first.inits = FALSE,
           hyperlink = FALSE, 
           dashed = FALSE)
my_bib = ReadBib("refs-all.bib", check = FALSE)
```

```{r get-refs, include=FALSE}
download.file("https://github.com/geocompr/geocompkg/raw/master/slides/refs-geostat.bib", "rg.bib")
download.file("https://github.com/Robinlovelace/geocompr/raw/master/refs.bib", "geocompr.bib")
refs_geostat = RefManageR::ReadBib("rg.bib")
refs_geocompr = RefManageR::ReadBib("geocompr.bib")
o = ls()
r = o[grepl(pattern = "refs_", x = o)]
refs = do.call(what = c, args = mget(r))
ref_df = as.data.frame(refs)
# View(ref_df)
RefManageR::WriteBib(refs, "refs-all.bib")
```

layout: true
background-image: url(xaringan_stuff/img/r_geocomp_background.png)
background-size: cover

---

## What is R?

"R is an integrated suite of software facilities for data manipulation, calculation and graphical display. Among other things it has

- an effective data handling and storage facility
- a suite of operators for calculations on arrays, in particular matrices,
- a large, coherent, integrated collection of intermediate tools for data analysis,
- graphical facilities for data analysis and display either directly at the computer or on hardcopy, and
- a well developed, simple and effective programming language [with] conditionals, loops, user defined recursive functions and input and output"

R Core Team (2019)

```{r, eval=FALSE}
help.start() # get started with R, from in R!
```

---

## Y R?

Start with broader questions:

- Why use a programming language at all?

- Because it allows you to do more things than monolithic programs driven by a graphical user interface (GUI) such as Microsoft Excel and ESRI's ArcMap.

- Why use a command-line interface (CLI)?

- It lets you get things done faster (once you learn the workflow)
- Scalability, e.g. the Propensity to Cycle Tool ([PCT](http://www.pct.bike/)) (Lovelace et al. 2019)
- Reproducibility

---

.pull-left[

![](https://imgs.xkcd.com/comics/the_difference.png)

]

--

.pull-right[


## What is Reproducibility?

> A process in which the same results can be generated by others using publicly accessible code

Consequences for research, science and participation.

"There is a tremendous amount
of flexibility and power waiting for you with the command line. Many times
you can do something on the command line in a fraction of the time you
can do it with a GUI" `r Citep(my_bib, "sherman_desktop_2008", .opts = list(cite.style = "authoryear"))`.

In R reproducibility can be as simple as sharing an R script!

Programming is necessary for data science and reproducibility, but which language?

]

---

background-image: url(https://stackoverflow.blog/wp-content/uploads/2017/10/tag_growth_scatter-1-771x675.png)
background-size: 85%

--

## Which language?

--


.pull-left[

- Large user community

- In your area of work

- Spatial, temporal and modelling capabilities

- Visualisation and statistical analysis

]

.pull-right[


```{r, echo=FALSE, out.width="100%", eval=FALSE}
knitr::include_graphics("https://stackoverflow.blog/wp-content/uploads/2017/10/tag_growth_scatter-1-771x675.png")
```

]

---

# RStudio - get it from [rstudio.com](https://www.rstudio.com/products/rstudio/download/)

- Multiplatform R editor for Linux, Mac + [web](https://mybinder.org/v2/gh/geocompr/RGSWorkshop/master?urlpath=rstudio)

![](https://raw.githubusercontent.com/ITSLeeds/TDS/master/courses/2day/images/rstudio-ui.png)

---

# Live demo

---

## An introduction to R's syntax

Everything that 'exists' is an object

---

## Assignment and style

```{r}
x = 1   # equals assignment
x <- 1  # arrow assignment
```

Which to use?

--

It's a matter of style. See [#319](https://github.com/Robinlovelace/geocompr/issues/319)

--

They do differ in very specific circumstances, e.g.


```{r, results='hide'}
system.time(y <- sqrt(1:1e6))
system.time({y = sqrt(1:1e6)})
```

- Assignment inside function call

--

- Good, consistent style helps communicate your work:

```{r}
sQuare_RootdeC=quantile(y,seq(0,1,0.1))   # bad
sqrt_deciles = quantile(y, probs = seq(0, 1, by = 0.1)) # good
```

---

# Vectors

- Creating vectors with `c()`

```{r}
person_name = c("arron", "bob", "carl")
n_coffee = c(5, 1, 0)
likes_tea = c(TRUE, FALSE, TRUE)
hometown = c("west-yorkshire", "avon", "london")
```

- R is vectorised

```{r}
is.vector(person_name)
is.vector(1)
```

---

## Vector classes

What is their class?

```{r}
class(person_name)
class(n_coffee)
```

--

What class is `likes_tea`?

---

## Class coercion

```{r}
n_coffee # print the object
```


```{r}
n_coffee_char = as.character(n_coffee)
```

```{r}
n_coffee_char
```


```{r}
person_name_numeric = as.numeric(person_name)
person_name_numeric
```

---

## Vector subsetting

```{r}
person_name[2]
person_name[c(FALSE, TRUE, FALSE)]
```

--

Recycling

```{r}
person_name[c(TRUE, FALSE)]
```

--

What just happened?

---

## Data frames

The most common and useful object type for many applications

```{r}
coffee_df = data.frame(
  person_name,
  n_coffee,
  likes_tea,
  hometown
  )
coffee_df
class(coffee_df)
```


---

## tibbles

```{r, echo=TRUE}
coffee = tibble::tibble(
  person_name,
  n_coffee,
  likes_tea,
  hometown
  )
coffee
class(coffee)
```

---

## Data frame operations - rows

```{r}
coffee[2, ]
dplyr::slice(coffee, 2)
coffee[coffee$likes_tea, ]
```

---

## Data fram operations - columns

```{r}
coffee[, 2]
dplyr::select(coffee, n_coffee)
coffee$n_coffee
```



---

## Functions

Everything that happens is a function

Functions take arguments


```{r}
quantile(n_coffee)
quantile(n_coffee, probs = c(0.1, 0.5, 0.9))
# ?quantile # get help!
quantile(n_coffee, names = FALSE)
```


---

## Base R plots

```{r}
plot(coffee$n_coffee)
```

---

## Next steps and getting help

- R is a language - needs practice

- Frequent use of R's help is recommended, e.g. with `?plot()`

- Check-out online communities such as StackOverflow and the RStudio community

--

Books

- Advanced R programming `r Citep(my_bib, "wickham_advanced_2014", .opts = list(cite.style = "authoryear"))`

- R for Data Science `r Citep(my_bib, "grolemund_r_2016", .opts = list(cite.style = "authoryear"))`

- Geocomputation with R `r Citep(my_bib, "lovelace_geocomputation_2019", .opts = list(cite.style = "authoryear"))`

<!-- [@lovelace_geocomputation_2019]  -->

---

# Exercises

- Get into groups of 2 to 5

- In your group decide: what would you like to use R for?

- What are other tools that you could use instead of/alongside R?

- What datasets would you like to be able to be able to read-on / analyse in R?

- What do you most want to get out of today's course?

--

- Practical bit: write and R script that creates a data frame with the name, numbers of cups of coffee, and hometown of each person in your group.

- Bonus (we'll come round to help): add the code you wrote to the script called `coffee.R` in the [github.com/geocompr/RGSWorkshop](https://github.com/geocompr/RGSWorkshop) repo


---

# References + contact

- To contact us about the book - go to [github.com/Robinlovelace/geocompr](https://github.com/Robinlovelace/geocompr)
- Social media: [#geocompr](https://twitter.com/hashtag/geocompr)
<!-- - Good old fashioned email: r.lovelace at leeds dot ac dot uk -->



```{r, 'refs', results="asis", echo=FALSE}
PrintBibliography(my_bib)
# RefManageR::WriteBib(my_bib, "refs-geostat.bib")
```

